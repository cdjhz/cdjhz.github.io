---
layout: post
title: 二维格点随机游走问题
categories: Math
tags: [probability theory]
mathjax: true
---

一个粒子在二维空间中作随机运动，方向可以是上，下，左，右四种，且各方向等概，每一步步长为1. 假定从原点出发，以第n步时粒子所在位置到原点的距离作为半径画圆，计算这个圆的面积的期望。

<!-- more -->

首先列出期望的两个性质：

### 性质一

任意函数\(\phi (x)\)，\(X\)为随机变量（以下简称\(r.v.\)），定义一个新的随机变量\(\\phi (X)\). 如果\(\\phi (X)\)具有有限的期望值，则：

\[E(\phi (X))=\sum_k \phi (x_k)f(x_k)\]

此处的级数绝对收敛当且仅当\(E(\phi (X))\)存在.

### 性质二

如果\(X_1,X_2,\cdots ,X_n\)都是具有有限期望值的\(r.v.\)，则它们的和的期望存在，且有：

\[E(X_1+X_2+\cdots+X_n)=E(X_1)+E(X_2)+\cdots+E(X_n)\]

这一性质对\(r.v.\)之间没有要求，也称为随机变量的线性性。

[William Feller]()在其 *An Introduction to Probability Theory and Its Application* 一书中给出了使用联合分布的证明。

只需考虑\(X,Y\)两个随机变量。

\[E(X+Y)=\sum_{j,k}(x_j+y_k)P(X=x_j,Y=y_k)=\sum_{j,k}x_j P(X=x_j,Y=y_k)+\sum_{j,k}y_k P(X=x_j,Y=y_k)\]

可以得到\(X\)的边缘分布:\(P(X=x_j)=\sum_kP(X=x_j,Y=y_k)\)，\(Y\)同理。

即得到：\[L.H.S=\sum_jx_jP(X=x_j)+\sum_ky_kP(Y=y_k)=E(X)+E(Y)\]

**直接计算失败后，从递归的角度考虑得到了答案。递归的方法从第三部分开始。**

--------------------

​	回到本题目，表征粒子运动的随机变量为它的坐标\((X,Y)\)，原题等价于求\(X^2+Y^2\)的期望。利用期望的第二个性质，可以分别求\(E(X^2)\)和\(E(Y^2)\)，再将它们相加得到结果。由于对称性，实际上只需求\(E(X^2)\)。

考虑粒子横坐标\(r.v.\)的分布\(P(X=k)\).需要注意的是粒子在横轴上移动的步数也是\(r.v.\)（介于0到n之间）设为\(X'\)。当横轴坐标为k，移动步数为m时，有：

\[P(X=k)=\sum_{m\ge 0}^nP(X=k, X'=m)\]

**上述写法其实有点问题，m并不能取到0～n中所有的值，因为粒子的运动是离散的**

假设粒子在横轴上沿着正方向移动了a个单位，负方向移动了b个单位则根据\(a+b=m,a-b=k\)可解出此情况下正方向移动的单位为\(\frac{m+k}{2}\)（需满足为整数）. 由于m步中每一步有两种选法，样本空间的大小为\(2^m\)；而m次中选了a次沿正向移动的情况有\(\binom{m}{\frac{m+k}{2}}\)种，故：

\[P(X=k,X'=m)=\frac{\binom{m}{\frac{m+k}{2}}}{2^m}\]

得到计算\(E(X^2)\)的总的表达式为：(由于对称性)

\[E(X^2)=2\sum_{k=0}^nk^2\sum_{m\ge 0}^nP(X=k,X'=m)\]

两个求和并非独立，第二个求和依赖于k的值。

-----------

​	上述方法计算过于复杂，弃坑了。受到启发尝试使用递归的方法解决，发现出奇的简单。（递归大法好！）先列出走n步时的期望，以下标\(n\)记。

\[E_n(X^2+Y^2)=\sum (x^2+y^2)P(X=x,Y=y)\]

设此时到达\((x,y)\)。再走一步时，比如说横轴正方向再走一步到达\((x+1,y)\)概率为：

\[P(X=x+1,Y=y)=P(X=x+1,Y=y\|X=x,Y=y)P(X=x,Y=y)=\frac{1}{4}P(X=x,Y=y)\]

同理对剩下的三个方向有类似的结果，则可以得到走\(n+1\)步时的所求期望：

\[E_{n+1}(X^2+Y^2)=\frac{1}{4}\sum {[(x+1)^2+y^2]+[x^2+(y+1)^2]+[(x-1)^2+y^2]+[x^2+(y-1)^2]} P(X=x,Y=y)\]

化简得到：

\[E_{n+1}(X^2+Y^2)=\sum (x^2+y^2+1)P(X=x,Y=y)=E_n(X^2+Y^2)+\sum P(X=x,Y=y)\]

后一项就是\(X,Y\)联合分布概率的归一，等于1！再根据边界条件\(E(0)=0\)得到

\[E_{n}(X^2+Y^2)=n\]

也就是说离散二维随机游走的距离平方的期望值就等于步数的大小！连续的情况其实也是类似，[A.Einstein](https://en.wikipedia.org/wiki/Albert_Einstein)曾经给出过布朗运动扩散的方均距离与时间的关系，即：

\[\bar{l^2} \propto t\]

