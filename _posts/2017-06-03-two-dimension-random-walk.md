---
layout: post
title: 二维格点随机游走问题
---

一个粒子在二维空间中作随机运动，方向可以是上，下，左，右四种，且各方向等概，每一步步长为1. 假定从原点出发，以第n步时粒子所在位置到原点的距离作为半径画圆，计算这个圆的面积的期望。

<!--more-->

首先列出期望的两个性质：

### 性质一

任意函数\\(\phi (x)\\)，\\(X\\)为随机变量（以下简称\\(r.v.\\)），定义一个新的随机变量\\(\\phi (X)\\). 如果\\(\\phi (X)\\)具有有限的期望值，则：

\\[E(\phi (X))=\sum_k \phi (x_k)f(x_k)\\]

此处的级数绝对收敛当且仅当\\(E(\phi (X))\\)存在.

### 性质二

如果\\(X_1,X_2,\cdots ,X_n\\)都是具有有限期望值的\\(r.v.\\)，则它们的和的期望存在，且有：

\\[E(X_1+X_2+\cdots+X_n)=E(X_1)+E(X_2)+\cdots+E(X_n)\\]

这一性质对\\(r.v.\\)之间没有要求，也称为随机变量的线性性。

[William Feller]()在其 *An Introduction to Probability Theory and Its Application* 一书中给出了使用联合分布的证明。

只需考虑\\(X,Y\\)两个随机变量。

\\[E(X+Y)=\sum_{j,k}(x_j+y_k)P(X=x_j,Y=y_k)=\sum_{j,k}x_j P(X=x_j,Y=y_k)+\sum_{j,k}y_k P(X=x_j,Y=y_k)\\]

可以得到\\(X\\)的边缘分布:\\(P(X=x_j)=\sum_kP(X=x_j,Y=y_k)\\)，\\(Y\\)同理。

即得到：\\[L.H.S=\sum_jx_jP(X=x_j)+\sum_ky_kP(Y=y_k)=E(X)+E(Y)\\]

--------------------

回到本题目，表征粒子运动的随机变量为它的坐标\\((X,Y)\\)，原题等价于求\\(X^2+Y^2\\)的期望。利用期望的第二个性质，可以分别求\\(E(X^2)\\)和\\(E(Y^2)\\)，再将它们相加得到结果。由于对称性，实际上只需求\\(E(X^2)\\)。

考虑粒子横坐标\\(r.v.\\)的分布\\(P(X=k)\\).需要注意的是粒子在横轴上移动的步数也是\\(r.v.\\)（介于0到n之间）设为\\(X'\\)。当横轴坐标为k，移动步数为m时，有：

\\[P(X=k)=\sum_{m\ge 0}^nP(X=k, X'=m)\\]

**上述写法其实有点问题，m并不能取到0～n中所有的值，因为粒子的运动是离散的**

假设粒子在横轴上沿着正方向移动了a个单位，负方向移动了b个单位则根据\\(a+b=m,a-b=k\\)可解出此情况下正方向移动的单位为\\(\frac{m+k}{2}\\)（需满足为整数）. 由于m步中每一步有两种选法，样本空间的大小为\\(2^m\\)；而m次中选了a次沿正向移动的情况有\\(\binom{m}{\frac{m+k}{2}}\\)种，故：

\\[P(X=k,X'=m)=\frac{\binom{m}{\frac{m+k}{2}}}{2^m}\\]

得到计算\\(E(X^2)\\)的总的表达式为：(由于对称性)

\\[E(X^2)=2\sum_{k=0}^nk^2\sum_{m\ge 0}^nP(X=k,X'=m)\\]

两个求和并非独立，第二个求和依赖于k的值。

*(Updating...)*

