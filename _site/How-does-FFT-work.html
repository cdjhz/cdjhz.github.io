<!DOCTYPE html>
<html>
  <head>
    <!-- meta information -->
<meta charset="utf-8">
<meta name="description" 
      content="Let’s first start with DFT (Discrete Fourier Transform)The vector \(y\) is the function to be expanded and the matrix..." >
<meta name="author" content="Haozhe Ji">

<!-- Enable responsiveness on mobile devices-->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<!-- title -->
<title>How does FFT work? &middot; </title>

<!-- icons -->
<link rel="shortcut icon" href="/public/images/favicon.ico" />

<!-- stylesheets -->
<link rel="stylesheet" href="/public/css/responsive.gs.12col.css">
<link rel="stylesheet" href="/public/css/animate.min.css">
<link rel="stylesheet" href="/public/css/main.css">

<!-- Google fonts -->
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,400italic&subset=latin-ext">



<!-- feed links -->
<link rel="alternate" href="http://localhost:4000/feed.xml" type="application/rss+xml" title="">
<link href='https://fonts.googleapis.com/css?family=Arvo:400,400italic,700,700italic' rel='stylesheet' type='text/css'>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
          }
        });
      
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
          for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
          }
        });
    </script>      
    <script type="text/javascript"
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
  </head>
  <body>
    <div class="container azul">
      <header class="top row gutters">
        <div class="col span_2 center">
          <!-- TODO: add baseurl to the logo link -->
          <a href="http://localhost:4000" id="logo" title="Thoughts of JHz"
             style="background-image: url(/public/images/logo.png);"></a>
        </div>
        <nav class="col span_10 top-navbar">
  
  <a href="/" title="Home"
     >Home</a>
  
  <a href="/about" title="About"
     >About</a>
  
  <a href="/info" title="Information"
     >Information</a>
  
</nav>

      </header>

      <article class="single row gutters">
  <time class="published" datetime="2017-06-15">15 June 2017</time>
  <h2>How does FFT work?</h2>

  
<p>Let’s first start with DFT (Discrete Fourier Transform)</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{bmatrix}
y_1\\\
y_2\\\
y_3\\\
\vdots\\\
y_n
\end{bmatrix}=
\begin{bmatrix}
1 & 1 & 1 & \cdots & 1 \\\
1 &  \omega & \omega^2 &\cdots & \omega^{n-1} \\\
1 & \omega^2 & \omega^4 & \cdots & \omega^{2n-2} \\\
\vdots & \vdots & \vdots & \ddots & \vdots \\\
1 & \omega^{n-1} &\omega^{2n-2} & \cdots & \omega^{(n-1)^2}
\end{bmatrix}
\begin{bmatrix}
c_1\\\
c_2\\\
c_3\\\
\vdots\\\
c_n
\end{bmatrix},\quad \omega=e^{\frac{2\pi i}{n}} %]]></script>

<!--more-->

<p>The vector \(y\) is the function to be expanded and the matrix multiplied by the coefficients \(c\) is the Fourier matrix \(F_n\); it is seen in <em>frequency space</em> through the coefficients \(c_k\). This formula is actually called the inverse Fourier transform. It can be seen from \(\omega\)(it has positive sign on \(\omega\)). Fourier transform is the one that computes the frequency expansion given the function value at each time step.</p>

<p>Compare to the continuous form of Fourier transform:</p>

<script type="math/tex; mode=display">f(t)=\int_{-\infty}^{+\infty}F(\nu)e^{2\pi i\nu t}d\nu</script>

<p>In the case of n order Fourier matrix, we have to compute</p>

<script type="math/tex; mode=display">y_j=\sum_{k=0}^{n-1}\omega^{jk}x_k, \quad j=0,1,\cdots,n-1</script>

<p>The complexity is \(O(n^2)\). The idea of FFT is to recursively compute the half size matrix (i.e. \(F_{n/2}, F_{n/4}, \cdots\)) and the complexity can be reduced to \(O(nlog(n))\).
The link between the origin matrix and its half sized counterpart is the property of complex number. Suppose \(m=\frac{n}{2}\), then \(\omega_m=\omega_n^2\) (It’s easy to see, since the m-order unit roots separate the unit circle into m parts.) 
For the first m entries of \(y\), we split the sum into even and odd parts.
\[y_j=\sum_{k=0}^{n-1}\omega_n^{jk}c_k=\sum_{k=0}^{n/2-1}\omega_n^{2jk}c_{2k}+\sum_{k=0}^{n/2-1}\omega_n^{j(2k+1)}c_{2k+1}, \quad j=0,1,\cdots, n/2-1\]
The even c’s go into \(c’=(c_0,c_2,\cdots)\) and the odd c’s go into \(c’’=(c_1,c_3,\cdots)\). Set \(y’=F_mc’,y’'=F_mc’’\). Then using \(\omega_m=\omega_n^2\), we can transform it into the combintion of \(y’ and y’’\).</p>

<script type="math/tex; mode=display">LHS=\sum_{k=0}^{m-1}\omega_m^{jk}c'_k + \omega_n^j \sum_{k=0}^{m-1}\omega_m^{jk}c''_k=y'_j+(\omega_n)^jy''_j</script>

<p>For \(j\ge m\), Noticing that \(\omega_n^m=-1\) we have:</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{equation} 
\begin{split}
y_{j+m} & = \sum_{k=0}^{n-1}\omega_n^{(j+m)k}c_{k} \\
& = \sum_{k=0}^{n/2-1}(-1)^{2k}\omega_n^{2jk}c_{2k}+\sum_{k=0}^{n/2-1}(-1)^{(2k+1)}\omega_n^{j(2k+1)}c_{2k+1} \\
& =\sum_{k=0}^{m-1}\omega_m^{jk}c'_k - \omega_n^j \sum_{k=0}^{m-1}\omega_m^{jk}c''_k \\
& = y'_j - (\omega_n)^j y''_j 
\end{split}
\end{equation} %]]></script>

<p>So here we are, the essential expansion in this recursion.</p>

<script type="math/tex; mode=display">\begin{align}
y_j=y'_j+\omega_n^jy''_j, \quad j=0,1,\cdots,m-1 \\
y_{j+m}=y'_j-\omega_n^jy''_j, \quad j=0,1,\cdots,m-1
\end{align}</script>

<p>The equations can be written in matrix expression.</p>

<script type="math/tex; mode=display">% <![CDATA[
y=
\begin{bmatrix}
I_m & D_m \\
I_m & -D_m
\end{bmatrix}
\begin{bmatrix}
y'\\
y''
\end{bmatrix}, \quad D_m=diag(1,\omega,\cdots, \omega^{m-1}) %]]></script>

<p>Remember the definition of \(y’ and y’’\).</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{bmatrix}
y'\\y''
\end{bmatrix}=
\begin{bmatrix}
F_m &O\\
O&F_m
\end{bmatrix}
\begin{bmatrix}
c'\\c''
\end{bmatrix} %]]></script>

<p>We are nearly there; the last matrix is an ‘even-odd’ permutation that separates the incoming vector \(c\) into its even and odd parts \(c’=(c_0,c_2,\cdots,c_{n-2}) and c’’=(c_1, c_3,\cdots,c_{n-1})\). For a direct look, we give the example of a 4-order even-odd permutation matrix:</p>

<script type="math/tex; mode=display">% <![CDATA[
P_4=\begin{bmatrix}
1 &&&\\
&&1&\\
&1&&\\
&&&1
\end{bmatrix} %]]></script>

<p>So one recursion of the FFT can be written as the multiplication of three matrix.</p>

<script type="math/tex; mode=display">% <![CDATA[
F_n=
\begin{bmatrix}
I_n/2 & D_n/2 \\
I_n/2 & -D_n/2
\end{bmatrix}
\begin{bmatrix}
F_n/2&O\\
O& F_n/2
\end{bmatrix}
P_n %]]></script>

<p>The whole algorithm will iteratively compute \(log_2(n)\) stages until it reaches the bottom. In each stage, The only computation is the multiplication between the diagonal matrix and the half sized Fourier matrix, which is \(\frac{n}{2}\) times of multiplications. So the complexity of the whole algorithm will be \(\frac{1}{2}nlog_2n\) .</p>

<p>As for the multiplication of the permutation, there is an elegant way of addressing it. Write the number 0 to n-1 in binary,  and rearrange them in order while reversing the order of their bits. Below shows an example of n=8.</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{matrix}
input& binary& reversed & output\\
0& 000& 000 & 0\\ 
1& 001& 100& 4\\
2& 010& 010& 2\\
3& 011& 110& 6\\
4& 100& 001& 1\\
5& 101& 101& 5\\
6& 110& 011& 3\\
7& 111& 111& 7\\
\end{matrix} %]]></script>

</article>
             
<ul class="posts posts--previous-next">
   
    <li>
      <h4 class="pagination-title"><a href="/two-dimension-random-walk">二维格点随机游走问题</a></h4>
      <h5 class="pagination-date">2017-06-03 00:00:00 +0800</h5>
      <p class="pagination-description"></p>
    </li>
  
   
    <li>
      <h4 class="pagination-title"><a href="/Incidence-Matrix">Incidence Matrix</a></h4>
      <h5 class="pagination-date">2017-06-18 00:00:00 +0800</h5>
      <p class="pagination-description"></p>
    </li>
  
</ul>


      <footer>
        <p>
            &copy; 2017 <a href="https://www.github.com/cdjhz">Haozhe Ji</a>
            <br>
            Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="https://github.com/aigarsdz/brume">Brume theme</a>.
        </p>
      </footer>
    </div>

    <!-- scripts -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="/public/js/jquery.fitvids.js"></script>
    <script>
      $(document).ready(function(){
        $("article").fitVids();
      });
    </script>
  </body>
</html>
