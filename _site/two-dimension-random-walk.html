<!DOCTYPE html>
<html>
  <head>
    <!-- meta information -->
<meta charset="utf-8">
<meta name="description" 
      content="一个粒子在二维空间中作随机运动，方向可以是上，下，左，右四种，且各方向等概，每一步步长为1. 假定从原点出发，以第n步时粒子所在位置到原点的距离作为半径画圆，计算这个圆的面积的期望。首先列出期望的两个性质：性质一任意函数\(\phi ..." >
<meta name="author" content="Haozhe Ji">

<!-- Enable responsiveness on mobile devices-->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<!-- title -->
<title>二维格点随机游走问题 &middot; </title>

<!-- icons -->
<link rel="shortcut icon" href="/public/images/favicon.ico" />

<!-- stylesheets -->
<link rel="stylesheet" href="/public/css/responsive.gs.12col.css">
<link rel="stylesheet" href="/public/css/animate.min.css">
<link rel="stylesheet" href="/public/css/main.css">

<!-- Google fonts -->
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,400italic&subset=latin-ext">



<!-- feed links -->
<link rel="alternate" href="http://localhost:4000/feed.xml" type="application/rss+xml" title="">
<link href='https://fonts.googleapis.com/css?family=Arvo:400,400italic,700,700italic' rel='stylesheet' type='text/css'>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
          }
        });
      
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
          for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
          }
        });
    </script>      
    <script type="text/javascript"
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
  </head>
  <body>
    <div class="container azul">
      <header class="top row gutters">
        <div class="col span_2 center">
          <!-- TODO: add baseurl to the logo link -->
          <a href="http://localhost:4000" id="logo" title="Thoughts of JHz"
             style="background-image: url(/public/images/logo.png);"></a>
        </div>
        <nav class="col span_10 top-navbar">
  
  <a href="/" title="Home"
     >Home</a>
  
  <a href="/about" title="About"
     >About</a>
  
  <a href="/info" title="Information"
     >Information</a>
  
</nav>

      </header>

      <article class="single row gutters">
  <time class="published" datetime="2017-06-03">03 June 2017</time>
  <h2>二维格点随机游走问题</h2>

  <p>一个粒子在二维空间中作随机运动，方向可以是上，下，左，右四种，且各方向等概，每一步步长为1. 假定从原点出发，以第n步时粒子所在位置到原点的距离作为半径画圆，计算这个圆的面积的期望。</p>

<!--more-->

<p>首先列出期望的两个性质：</p>

<h3 id="性质一">性质一</h3>

<p>任意函数\(\phi (x)\)，\(X\)为随机变量（以下简称\(r.v.\)），定义一个新的随机变量\(\phi (X)\). 如果\(\phi (X)\)具有有限的期望值，则：</p>

<p>\[E(\phi (X))=\sum_k \phi (x_k)f(x_k)\]</p>

<p>此处的级数绝对收敛当且仅当\(E(\phi (X))\)存在.</p>

<h3 id="性质二">性质二</h3>

<p>如果\(X_1,X_2,\cdots ,X_n\)都是具有有限期望值的\(r.v.\)，则它们的和的期望存在，且有：</p>

<p>\[E(X_1+X_2+\cdots+X_n)=E(X_1)+E(X_2)+\cdots+E(X_n)\]</p>

<p>这一性质对\(r.v.\)之间没有要求，也称为随机变量的线性性。</p>

<p><a href="">William Feller</a>在其 <em>An Introduction to Probability Theory and Its Application</em> 一书中给出了使用联合分布的证明。</p>

<p>只需考虑\(X,Y\)两个随机变量。</p>

<p>\[E(X+Y)=\sum_{j,k}(x_j+y_k)P(X=x_j,Y=y_k)=\sum_{j,k}x_j P(X=x_j,Y=y_k)+\sum_{j,k}y_k P(X=x_j,Y=y_k)\]</p>

<p>可以得到\(X\)的边缘分布:\(P(X=x_j)=\sum_kP(X=x_j,Y=y_k)\)，\(Y\)同理。</p>

<p>即得到：\[L.H.S=\sum_jx_jP(X=x_j)+\sum_ky_kP(Y=y_k)=E(X)+E(Y)\]</p>

<p><strong>直接计算失败后，从递归的角度考虑得到了答案。递归的方法从第三部分开始。</strong></p>

<hr />

<p>​	回到本题目，表征粒子运动的随机变量为它的坐标\((X,Y)\)，原题等价于求\(X^2+Y^2\)的期望。利用期望的第二个性质，可以分别求\(E(X^2)\)和\(E(Y^2)\)，再将它们相加得到结果。由于对称性，实际上只需求\(E(X^2)\)。</p>

<p>考虑粒子横坐标\(r.v.\)的分布\(P(X=k)\).需要注意的是粒子在横轴上移动的步数也是\(r.v.\)（介于0到n之间）设为\(X’\)。当横轴坐标为k，移动步数为m时，有：</p>

<p>\[P(X=k)=\sum_{m\ge 0}^nP(X=k, X’=m)\]</p>

<p><strong>上述写法其实有点问题，m并不能取到0～n中所有的值，因为粒子的运动是离散的</strong></p>

<p>假设粒子在横轴上沿着正方向移动了a个单位，负方向移动了b个单位则根据\(a+b=m,a-b=k\)可解出此情况下正方向移动的单位为\(\frac{m+k}{2}\)（需满足为整数）. 由于m步中每一步有两种选法，样本空间的大小为\(2^m\)；而m次中选了a次沿正向移动的情况有\(\binom{m}{\frac{m+k}{2}}\)种，故：</p>

<p>\[P(X=k,X’=m)=\frac{\binom{m}{\frac{m+k}{2}}}{2^m}\]</p>

<p>得到计算\(E(X^2)\)的总的表达式为：(由于对称性)</p>

<p>\[E(X^2)=2\sum_{k=0}^nk^2\sum_{m\ge 0}^nP(X=k,X’=m)\]</p>

<p>两个求和并非独立，第二个求和依赖于k的值。</p>

<hr />

<p>​	上述方法计算过于复杂，弃坑了。受到启发尝试使用递归的方法解决，发现出奇的简单。（递归大法好！）先列出走n步时的期望，以下标\(n\)记。</p>

<p>\[E_n(X^2+Y^2)=\sum (x^2+y^2)P(X=x,Y=y)\]</p>

<p>设此时到达\((x,y)\)。再走一步时，比如说横轴正方向再走一步到达\((x+1,y)\)概率为：</p>

<p>\[P(X=x+1,Y=y)=P(X=x+1,Y=y|X=x,Y=y)P(X=x,Y=y)=\frac{1}{4}P(X=x,Y=y)\]</p>

<p>同理对剩下的三个方向有类似的结果，则可以得到走\(n+1\)步时的所求期望：</p>

<p>\[E_{n+1}(X^2+Y^2)=\frac{1}{4}\sum {[(x+1)^2+y^2]+[x^2+(y+1)^2]+[(x-1)^2+y^2]+[x^2+(y-1)^2]} P(X=x,Y=y)\]</p>

<p>化简得到：</p>

<p>\[E_{n+1}(X^2+Y^2)=\sum (x^2+y^2+1)P(X=x,Y=y)=E_n(X^2+Y^2)+\sum P(X=x,Y=y)\]</p>

<p>后一项就是\(X,Y\)联合分布概率的归一，等于1！再根据边界条件\(E(0)=0\)得到</p>

<p>\[E_{n}(X^2+Y^2)=n\]</p>

<p>也就是说离散二维随机游走的距离平方的期望值就等于步数的大小！连续的情况其实也是类似，<a href="https://en.wikipedia.org/wiki/Albert_Einstein">A.Einstein</a>曾经给出过布朗运动扩散的方均距离与时间的关系，即：</p>

<p>\[\bar{l^2} \propto t\]</p>


</article>
             
<ul class="posts posts--previous-next">
   
    <li>
      <h4 class="pagination-title"><a href="/ssh-keygen">ssh-keygen实现密钥登录远程服务器</a></h4>
      <h5 class="pagination-date">2017-05-29 00:00:00 +0800</h5>
      <p class="pagination-description"></p>
    </li>
  
   
    <li>
      <h4 class="pagination-title"><a href="/How-does-FFT-work">How does FFT work?</a></h4>
      <h5 class="pagination-date">2017-06-15 00:00:00 +0800</h5>
      <p class="pagination-description"></p>
    </li>
  
</ul>


      <footer>
        <p>
            &copy; 2017 <a href="https://www.github.com/cdjhz">Haozhe Ji</a>
            <br>
            Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="https://github.com/aigarsdz/brume">Brume theme</a>.
        </p>
      </footer>
    </div>

    <!-- scripts -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="/public/js/jquery.fitvids.js"></script>
    <script>
      $(document).ready(function(){
        $("article").fitVids();
      });
    </script>
  </body>
</html>
